// Chat Box

function transliterate(oldText,newAlphabet){
  const oldAlphabet=
        'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ';
  let newText='';
  for(let i=0;i<oldText.length;++i){
    let char=oldText[i];
    let j=oldAlphabet.indexOf(char);
    if(j>=0)char=newAlphabet[j];
    newText=newText+char;}
  return newText;}

function substitute(text,regex,newAlphabet){
  const match=text.match(regex);
  if(match===null)return text;
  if(match.length!=4)return text;
  match[2]=transliterate(match[2],newAlphabet);
  return match[1]+match[2]+match[3];}

function inputChatKeyPress(){
  const circleWhite=[
    'â“','â“‘','â“’','â““','â“”','â“•','â“–','â“—','â“˜','â“™','â“š','â“›','â“œ',
    'â“','â“','â“Ÿ','â“ ','â“¡','â“¢','â“£','â“¤','â“¥','â“¦','â“§','â“¨','â“©',
    'â’¶','â’·','â’¸','â’¹','â’º','â’»','â’¼','â’½','â’¾','â’¿','â“€','â“','â“‚',
    'â“ƒ','â“„','â“…','â“†','â“‡','â“ˆ','â“‰','â“Š','â“‹','â“Œ','â“','â“','â“'];
  const courier=[
    'ğšŠ','ğš‹','ğšŒ','ğš','ğš','ğš','ğš','ğš‘','ğš’','ğš“','ğš”','ğš•','ğš–',
    'ğš—','ğš˜','ğš™','ğšš','ğš›','ğšœ','ğš','ğš','ğšŸ','ğš ','ğš¡','ğš¢','ğš£',
    'ğ™°','ğ™±','ğ™²','ğ™³','ğ™´','ğ™µ','ğ™¶','ğ™·','ğ™¸','ğ™¹','ğ™º','ğ™»','ğ™¼',
    'ğ™½','ğ™¾','ğ™¿','ğš€','ğš','ğš‚','ğšƒ','ğš„','ğš…','ğš†','ğš‡','ğšˆ','ğš‰'];
  // Some letters are missing
  const cursive=[
    'ğ’¶','ğ’·','ğ’¸','ğ’¹','ğ‘’','ğ’»','ğ‘”','ğ’½','ğ’¾','ğ’¿','ğ“€','ğ“','ğ“‚',
    'ğ“ƒ','ğ‘œ','ğ“…','ğ“†','ğ“‡','ğ“ˆ','ğ“‰','ğ“Š','ğ“‹','ğ“Œ','ğ“','ğ“','ğ“',
    'ğ’œ','ğµ','ğ’','ğ’Ÿ','ğ¸','ğ¹','ğ’¢','ğ»','ğ¼','ğ’¥','ğ’¦','ğ¿','ğ‘€',
    'ğ’©','ğ’ª','ğ’«','ğ’¬','ğ‘…','ğ’®','ğ’¯','ğ’°','ğ’±','ğ’²','ğ’³','ğ’´','ğ’µ'];
  const cursiveBold=[
    'ğ“ª','ğ“«','ğ“¬','ğ“­','ğ“®','ğ“¯','ğ“°','ğ“±','ğ“²','ğ“³','ğ“´','ğ“µ','ğ“¶',
    'ğ“·','ğ“¸','ğ“¹','ğ“º','ğ“»','ğ“¼','ğ“½','ğ“¾','ğ“¿','ğ”€','ğ”','ğ”‚','ğ”ƒ',
    'ğ“','ğ“‘','ğ“’','ğ““','ğ“”','ğ“•','ğ“–','ğ“—','ğ“˜','ğ“™','ğ“š','ğ“›','ğ“œ',
    'ğ“','ğ“','ğ“Ÿ','ğ“ ','ğ“¡','ğ“¢','ğ“£','ğ“¤','ğ“¥','ğ“¦','ğ“§','ğ“¨','ğ“©'];
  const fraktur=[
    'ğ”','ğ”Ÿ','ğ” ','ğ”¡','ğ”¢','ğ”£','ğ”¤','ğ”¥','ğ”¦','ğ”§','ğ”¨','ğ”©','ğ”ª',
    'ğ”«','ğ”¬','ğ”­','ğ”®','ğ”¯','ğ”°','ğ”±','ğ”²','ğ”³','ğ”´','ğ”µ','ğ”¶','ğ”·',
    'ğ”„','ğ”…','â„­','ğ”‡','ğ”ˆ','ğ”‰','ğ”Š','â„Œ','â„‘','ğ”','ğ”','ğ”','ğ”',
    'ğ”‘','ğ”’','ğ”“','ğ””','â„œ','ğ”–','ğ”—','ğ”˜','ğ”™','ğ”š','ğ”›','ğ”œ','â„¨'];
  const frakturBold=[
    'ğ–†','ğ–‡','ğ–ˆ','ğ–‰','ğ–Š','ğ–‹','ğ–Œ','ğ–','ğ–','ğ–','ğ–','ğ–‘','ğ–’',
    'ğ–“','ğ–”','ğ–•','ğ––','ğ–—','ğ–˜','ğ–™','ğ–š','ğ–›','ğ–œ','ğ–','ğ–','ğ–Ÿ',
    'ğ•¬','ğ•­','ğ•®','ğ•¯','ğ•°','ğ•±','ğ•²','ğ•³','ğ•´','ğ•µ','ğ•¶','ğ•·','ğ•¸',
    'ğ•¹','ğ•º','ğ•»','ğ•¼','ğ•½','ğ•¾','ğ•¿','ğ–€','ğ–','ğ–‚','ğ–ƒ','ğ–„','ğ–…'];
  const outline=[
    'ğ•’','ğ•“','ğ•”','ğ••','ğ•–','ğ•—','ğ•˜','ğ•™','ğ•š','ğ•›','ğ•œ','ğ•','ğ•',
    'ğ•Ÿ','ğ• ','ğ•¡','ğ•¢','ğ•£','ğ•¤','ğ•¥','ğ•¦','ğ•§','ğ•¨','ğ•©','ğ•ª','ğ•«',
    'ğ”¸','ğ”¹','â„‚','ğ”»','ğ”¼','ğ”½','ğ”¾','â„','ğ•€','ğ•','ğ•‚','ğ•ƒ','ğ•„',
    'â„•','ğ•†','â„™','â„š','â„','ğ•Š','ğ•‹','ğ•Œ','ğ•','ğ•','ğ•','ğ•','â„¤'];
  const sansBold=[
    'ğ—®','ğ—¯','ğ—°','ğ—±','ğ—²','ğ—³','ğ—´','ğ—µ','ğ—¶','ğ—·','ğ—¸','ğ—¹','ğ—º',
    'ğ—»','ğ—¼','ğ—½','ğ—¾','ğ—¿','ğ˜€','ğ˜','ğ˜‚','ğ˜ƒ','ğ˜„','ğ˜…','ğ˜†','ğ˜‡',
    'ğ—”','ğ—•','ğ—–','ğ——','ğ—˜','ğ—™','ğ—š','ğ—›','ğ—œ','ğ—','ğ—','ğ—Ÿ','ğ— ',
    'ğ—¡','ğ—¢','ğ—£','ğ—¤','ğ—¥','ğ—¦','ğ—§','ğ—¨','ğ—©','ğ—ª','ğ—«','ğ—¬','ğ—­'];
  const sansBoldItalic=[
    'ğ™–','ğ™—','ğ™˜','ğ™™','ğ™š','ğ™›','ğ™œ','ğ™','ğ™','ğ™Ÿ','ğ™ ','ğ™¡','ğ™¢',
    'ğ™£','ğ™¤','ğ™¥','ğ™¦','ğ™§','ğ™¨','ğ™©','ğ™ª','ğ™«','ğ™¬','ğ™­','ğ™®','ğ™¯',
    'ğ˜¼','ğ˜½','ğ˜¾','ğ˜¿','ğ™€','ğ™','ğ™‚','ğ™ƒ','ğ™„','ğ™…','ğ™†','ğ™‡','ğ™ˆ',
    'ğ™‰','ğ™Š','ğ™‹','ğ™Œ','ğ™','ğ™','ğ™','ğ™','ğ™‘','ğ™’','ğ™“','ğ™”','ğ™•'];
  const serifBold=[
    'ğš','ğ›','ğœ','ğ','ğ','ğŸ','ğ ','ğ¡','ğ¢','ğ£','ğ¤','ğ¥','ğ¦',
    'ğ§','ğ¨','ğ©','ğª','ğ«','ğ¬','ğ­','ğ®','ğ¯','ğ°','ğ±','ğ²','ğ³',
    'ğ€','ğ','ğ‚','ğƒ','ğ„','ğ…','ğ†','ğ‡','ğˆ','ğ‰','ğŠ','ğ‹','ğŒ',
    'ğ','ğ','ğ','ğ','ğ‘','ğ’','ğ“','ğ”','ğ•','ğ–','ğ—','ğ˜','ğ™'];
  const serifBoldItalic=[
    'ğ’‚','ğ’ƒ','ğ’„','ğ’…','ğ’†','ğ’‡','ğ’ˆ','ğ’‰','ğ’Š','ğ’‹','ğ’Œ','ğ’','ğ’',
    'ğ’','ğ’','ğ’‘','ğ’’','ğ’“','ğ’”','ğ’•','ğ’–','ğ’—','ğ’˜','ğ’™','ğ’š','ğ’›',
    'ğ‘¨','ğ‘©','ğ‘ª','ğ‘«','ğ‘¬','ğ‘­','ğ‘®','ğ‘¯','ğ‘°','ğ‘±','ğ‘²','ğ‘³','ğ‘´',
    'ğ‘µ','ğ‘¶','ğ‘·','ğ‘¸','ğ‘¹','ğ‘º','ğ‘»','ğ‘¼','ğ‘½','ğ‘¾','ğ‘¿','ğ’€','ğ’'];
  const squareBlack=[
    'ğŸ…°','ğŸ…±','ğŸ…²','ğŸ…³','ğŸ…´','ğŸ…µ','ğŸ…¶','ğŸ…·','ğŸ…¸','ğŸ…¹','ğŸ…º','ğŸ…»','ğŸ…¼',
    'ğŸ…½','ğŸ…¾','ğŸ…¿','ğŸ†€','ğŸ†','ğŸ†‚','ğŸ†ƒ','ğŸ†„','ğŸ†…','ğŸ††','ğŸ†‡','ğŸ†ˆ','ğŸ†‰',
    'ğŸ…°','ğŸ…±','ğŸ…²','ğŸ…³','ğŸ…´','ğŸ…µ','ğŸ…¶','ğŸ…·','ğŸ…¸','ğŸ…¹','ğŸ…º','ğŸ…»','ğŸ…¼',
    'ğŸ…½','ğŸ…¾','ğŸ…¿','ğŸ†€','ğŸ†','ğŸ†‚','ğŸ†ƒ','ğŸ†„','ğŸ†…','ğŸ††','ğŸ†‡','ğŸ†ˆ','ğŸ†‰'];
  const squareWhite=[
    'ğŸ„°','ğŸ„±','ğŸ„²','ğŸ„³','ğŸ„´','ğŸ„µ','ğŸ„¶','ğŸ„·','ğŸ„¸','ğŸ„¹','ğŸ„º','ğŸ„»','ğŸ„¼',
    'ğŸ„½','ğŸ„¾','ğŸ„¿','ğŸ…€','ğŸ…','ğŸ…‚','ğŸ…ƒ','ğŸ…„','ğŸ……','ğŸ…†','ğŸ…‡','ğŸ…ˆ','ğŸ…‰',
    'ğŸ„°','ğŸ„±','ğŸ„²','ğŸ„³','ğŸ„´','ğŸ„µ','ğŸ„¶','ğŸ„·','ğŸ„¸','ğŸ„¹','ğŸ„º','ğŸ„»','ğŸ„¼',
    'ğŸ„½','ğŸ„¾','ğŸ„¿','ğŸ…€','ğŸ…','ğŸ…‚','ğŸ…ƒ','ğŸ…„','ğŸ……','ğŸ…†','ğŸ…‡','ğŸ…ˆ','ğŸ…‰'];
  const underline=[
    'aÌ²','bÌ²','cÌ²','dÌ²','eÌ²','fÌ²','gÌ²','hÌ²','iÌ²','jÌ²','kÌ²','lÌ²','mÌ²',
    'nÌ²','oÌ²','pÌ²','qÌ²','rÌ²','sÌ²','tÌ²','uÌ²','vÌ²','wÌ²','xÌ²','yÌ²','zÌ²',
    'AÌ²','BÌ²','CÌ²','DÌ²','EÌ²','FÌ²','GÌ²','HÌ²','IÌ²','JÌ²','KÌ²','LÌ²','MÌ²',
    'NÌ²','OÌ²','PÌ²','QÌ²','RÌ²','SÌ²','TÌ²','UÌ²','VÌ²','WÌ²','XÌ²','YÌ²','ZÌ²'];
  // This doesn't work as expected in all fonts
  const underlineTwice=[
    'aÌ³','bÌ³','cÌ³','dÌ³','eÌ³','fÌ³','gÌ³','hÌ³','iÌ³','jÌ³','kÌ³','lÌ³','mÌ³',
    'nÌ³','oÌ³','pÌ³','qÌ³','rÌ³','sÌ³','tÌ³','uÌ³','vÌ³','wÌ³','xÌ³','yÌ³','zÌ³',
    'AÌ³','BÌ³','CÌ³','DÌ³','EÌ³','FÌ³','GÌ³','HÌ³','IÌ³','JÌ³','KÌ³','LÌ³','MÌ³',
    'NÌ³','OÌ³','PÌ³','QÌ³','RÌ³','SÌ³','TÌ³','UÌ³','VÌ³','WÌ³','XÌ³','YÌ³','ZÌ³'];
  const inputChat=document.getElementById('InputChat');
  let text=inputChat.value;
  if(text.length>0&&text[0]==' ')return true;
  // Bold
  text=substitute(text,/^(.*)\*(.+)\*(.*)$/,sansBold);
  // Circle
  text=substitute(text,/^(.*)\(\((.+)\)\)(.*)$/,circleWhite);
  // Courier
  text=substitute(text,/^(.*)=(.+)=(.*)$/,courier);
  // Cursive
  text=substitute(text,/^(.*)~(.+)~(.*)$/,cursiveBold);
  // Fraktur
  if(text.match(/^(.*)##(.*)#(.*)$/)===null
     &&text.match(/^(.*)#(.*)##(.*)$/)===null)
    text=substitute(text,/^(.*)#(.+)#(.*)$/,fraktur);
  text=substitute(text,/^(.*)##(.+)##(.*)$/,frakturBold);
  // Italic
  text=substitute(text,/^(.*)\/(.+)\/(.*)$/,sansBoldItalic);
  // Outline
  text=substitute(text,/^(.*)\|(.+)\|(.*)$/,outline);
  // Square
  text=substitute(text,/^(.*)\[\[(.+)\]\](.*)$/,squareWhite);
  // Underline
  text=substitute(text,/^(.*)_(.+)_(.*)$/,underline);
  inputChat.value=text;
  return true;}

function chatHelp(){
  console.log('Entry must not start with a space');
  console.log('*bold*      ğ—¯ğ—¼ğ—¹ğ—±');
  console.log('((circle))  â“’â“˜â“¡â“’â“›â“”');
  console.log('=courier=   ğšŒğš˜ğšğš›ğš’ğšğš›');
  console.log('~cursive~   ğ“¬ğ“¾ğ“»ğ“¼ğ“²ğ“¿ğ“®');
  console.log('#fraktur#   ğ”£ğ”¯ğ”ğ”¨ğ”±ğ”²ğ”¯');
  console.log('##fr bold## ğ–‹ğ–— ğ–‡ğ–”ğ–‘ğ–‰');
  console.log('/italic/    ğ™ğ™©ğ™–ğ™¡ğ™ğ™˜');
  console.log('|outline|   ğ• ğ•¦ğ•¥ğ•ğ•šğ•Ÿğ•–');
  console.log('[[square]]  ğŸ…‚ğŸ…€ğŸ…„ğŸ„°ğŸ…ğŸ„´');
  console.log('_underline_ uÌ²nÌ²dÌ²eÌ²rÌ²lÌ²iÌ²nÌ²eÌ²');}

function chatInit(){
  let inputChat=document.getElementById('InputChat');
  if(inputChat===null){
    console.log('No chat box found');
    return;}
  inputChat.setAttribute('onkeyup','inputChatKeyPress()');
  chatHelp();}

chatInit();
