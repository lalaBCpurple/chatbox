// Chat Box

function chatBoxTransliterate(oldText,newAlphabet){
  const oldAlphabet=
        'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ';
  let newText='';
  for(let i=0;i<oldText.length;++i){
    let char=oldText[i];
    let j=oldAlphabet.indexOf(char);
    if(j>=0)char=newAlphabet[j];
    newText=newText+char;}
  return newText;}

function chatBoxSubstitute(text,regex,newAlphabet){
  const match=text.match(regex);
  if(match===null)return text;
  if(match.length!=4)return text;
  match[2]=chatBoxTransliterate(match[2],newAlphabet);
  return match[1]+match[2]+match[3];}

function chatBoxTransform(){
  const circleWhite=[
    'â“','â“‘','â“’','â““','â“”','â“•','â“–','â“—','â“˜','â“™','â“š','â“›','â“œ',
    'â“','â“ž','â“Ÿ','â“ ','â“¡','â“¢','â“£','â“¤','â“¥','â“¦','â“§','â“¨','â“©',
    'â’¶','â’·','â’¸','â’¹','â’º','â’»','â’¼','â’½','â’¾','â’¿','â“€','â“','â“‚',
    'â“ƒ','â“„','â“…','â“†','â“‡','â“ˆ','â“‰','â“Š','â“‹','â“Œ','â“','â“Ž','â“'];
  const courier=[
    'ðšŠ','ðš‹','ðšŒ','ðš','ðšŽ','ðš','ðš','ðš‘','ðš’','ðš“','ðš”','ðš•','ðš–',
    'ðš—','ðš˜','ðš™','ðšš','ðš›','ðšœ','ðš','ðšž','ðšŸ','ðš ','ðš¡','ðš¢','ðš£',
    'ð™°','ð™±','ð™²','ð™³','ð™´','ð™µ','ð™¶','ð™·','ð™¸','ð™¹','ð™º','ð™»','ð™¼',
    'ð™½','ð™¾','ð™¿','ðš€','ðš','ðš‚','ðšƒ','ðš„','ðš…','ðš†','ðš‡','ðšˆ','ðš‰'];
  // Some letters are missing
  const cursive=[
    'ð’¶','ð’·','ð’¸','ð’¹','ð‘’','ð’»','ð‘”','ð’½','ð’¾','ð’¿','ð“€','ð“','ð“‚',
    'ð“ƒ','ð‘œ','ð“…','ð“†','ð“‡','ð“ˆ','ð“‰','ð“Š','ð“‹','ð“Œ','ð“','ð“Ž','ð“',
    'ð’œ','ðµ','ð’ž','ð’Ÿ','ð¸','ð¹','ð’¢','ð»','ð¼','ð’¥','ð’¦','ð¿','ð‘€',
    'ð’©','ð’ª','ð’«','ð’¬','ð‘…','ð’®','ð’¯','ð’°','ð’±','ð’²','ð’³','ð’´','ð’µ'];
  const cursiveBold=[
    'ð“ª','ð“«','ð“¬','ð“­','ð“®','ð“¯','ð“°','ð“±','ð“²','ð“³','ð“´','ð“µ','ð“¶',
    'ð“·','ð“¸','ð“¹','ð“º','ð“»','ð“¼','ð“½','ð“¾','ð“¿','ð”€','ð”','ð”‚','ð”ƒ',
    'ð“','ð“‘','ð“’','ð““','ð“”','ð“•','ð“–','ð“—','ð“˜','ð“™','ð“š','ð“›','ð“œ',
    'ð“','ð“ž','ð“Ÿ','ð“ ','ð“¡','ð“¢','ð“£','ð“¤','ð“¥','ð“¦','ð“§','ð“¨','ð“©'];
  const fraktur=[
    'ð”ž','ð”Ÿ','ð” ','ð”¡','ð”¢','ð”£','ð”¤','ð”¥','ð”¦','ð”§','ð”¨','ð”©','ð”ª',
    'ð”«','ð”¬','ð”­','ð”®','ð”¯','ð”°','ð”±','ð”²','ð”³','ð”´','ð”µ','ð”¶','ð”·',
    'ð”„','ð”…','â„­','ð”‡','ð”ˆ','ð”‰','ð”Š','â„Œ','â„‘','ð”','ð”Ž','ð”','ð”',
    'ð”‘','ð”’','ð”“','ð””','â„œ','ð”–','ð”—','ð”˜','ð”™','ð”š','ð”›','ð”œ','â„¨'];
  const frakturBold=[
    'ð–†','ð–‡','ð–ˆ','ð–‰','ð–Š','ð–‹','ð–Œ','ð–','ð–Ž','ð–','ð–','ð–‘','ð–’',
    'ð–“','ð–”','ð–•','ð––','ð–—','ð–˜','ð–™','ð–š','ð–›','ð–œ','ð–','ð–ž','ð–Ÿ',
    'ð•¬','ð•­','ð•®','ð•¯','ð•°','ð•±','ð•²','ð•³','ð•´','ð•µ','ð•¶','ð•·','ð•¸',
    'ð•¹','ð•º','ð•»','ð•¼','ð•½','ð•¾','ð•¿','ð–€','ð–','ð–‚','ð–ƒ','ð–„','ð–…'];
  const outline=[
    'ð•’','ð•“','ð•”','ð••','ð•–','ð•—','ð•˜','ð•™','ð•š','ð•›','ð•œ','ð•','ð•ž',
    'ð•Ÿ','ð• ','ð•¡','ð•¢','ð•£','ð•¤','ð•¥','ð•¦','ð•§','ð•¨','ð•©','ð•ª','ð•«',
    'ð”¸','ð”¹','â„‚','ð”»','ð”¼','ð”½','ð”¾','â„','ð•€','ð•','ð•‚','ð•ƒ','ð•„',
    'â„•','ð•†','â„™','â„š','â„','ð•Š','ð•‹','ð•Œ','ð•','ð•Ž','ð•','ð•','â„¤'];
  const sansBold=[
    'ð—®','ð—¯','ð—°','ð—±','ð—²','ð—³','ð—´','ð—µ','ð—¶','ð—·','ð—¸','ð—¹','ð—º',
    'ð—»','ð—¼','ð—½','ð—¾','ð—¿','ð˜€','ð˜','ð˜‚','ð˜ƒ','ð˜„','ð˜…','ð˜†','ð˜‡',
    'ð—”','ð—•','ð—–','ð——','ð—˜','ð—™','ð—š','ð—›','ð—œ','ð—','ð—ž','ð—Ÿ','ð— ',
    'ð—¡','ð—¢','ð—£','ð—¤','ð—¥','ð—¦','ð—§','ð—¨','ð—©','ð—ª','ð—«','ð—¬','ð—­'];
  const sansBoldItalic=[
    'ð™–','ð™—','ð™˜','ð™™','ð™š','ð™›','ð™œ','ð™','ð™ž','ð™Ÿ','ð™ ','ð™¡','ð™¢',
    'ð™£','ð™¤','ð™¥','ð™¦','ð™§','ð™¨','ð™©','ð™ª','ð™«','ð™¬','ð™­','ð™®','ð™¯',
    'ð˜¼','ð˜½','ð˜¾','ð˜¿','ð™€','ð™','ð™‚','ð™ƒ','ð™„','ð™…','ð™†','ð™‡','ð™ˆ',
    'ð™‰','ð™Š','ð™‹','ð™Œ','ð™','ð™Ž','ð™','ð™','ð™‘','ð™’','ð™“','ð™”','ð™•'];
  const serifBold=[
    'ðš','ð›','ðœ','ð','ðž','ðŸ','ð ','ð¡','ð¢','ð£','ð¤','ð¥','ð¦',
    'ð§','ð¨','ð©','ðª','ð«','ð¬','ð­','ð®','ð¯','ð°','ð±','ð²','ð³',
    'ð€','ð','ð‚','ðƒ','ð„','ð…','ð†','ð‡','ðˆ','ð‰','ðŠ','ð‹','ðŒ',
    'ð','ðŽ','ð','ð','ð‘','ð’','ð“','ð”','ð•','ð–','ð—','ð˜','ð™'];
  const serifBoldItalic=[
    'ð’‚','ð’ƒ','ð’„','ð’…','ð’†','ð’‡','ð’ˆ','ð’‰','ð’Š','ð’‹','ð’Œ','ð’','ð’Ž',
    'ð’','ð’','ð’‘','ð’’','ð’“','ð’”','ð’•','ð’–','ð’—','ð’˜','ð’™','ð’š','ð’›',
    'ð‘¨','ð‘©','ð‘ª','ð‘«','ð‘¬','ð‘­','ð‘®','ð‘¯','ð‘°','ð‘±','ð‘²','ð‘³','ð‘´',
    'ð‘µ','ð‘¶','ð‘·','ð‘¸','ð‘¹','ð‘º','ð‘»','ð‘¼','ð‘½','ð‘¾','ð‘¿','ð’€','ð’'];
  const squareBlack=[
    'ðŸ…°','ðŸ…±','ðŸ…²','ðŸ…³','ðŸ…´','ðŸ…µ','ðŸ…¶','ðŸ…·','ðŸ…¸','ðŸ…¹','ðŸ…º','ðŸ…»','ðŸ…¼',
    'ðŸ…½','ðŸ…¾','ðŸ…¿','ðŸ†€','ðŸ†','ðŸ†‚','ðŸ†ƒ','ðŸ†„','ðŸ†…','ðŸ††','ðŸ†‡','ðŸ†ˆ','ðŸ†‰',
    'ðŸ…°','ðŸ…±','ðŸ…²','ðŸ…³','ðŸ…´','ðŸ…µ','ðŸ…¶','ðŸ…·','ðŸ…¸','ðŸ…¹','ðŸ…º','ðŸ…»','ðŸ…¼',
    'ðŸ…½','ðŸ…¾','ðŸ…¿','ðŸ†€','ðŸ†','ðŸ†‚','ðŸ†ƒ','ðŸ†„','ðŸ†…','ðŸ††','ðŸ†‡','ðŸ†ˆ','ðŸ†‰'];
  const squareWhite=[
    'ðŸ„°','ðŸ„±','ðŸ„²','ðŸ„³','ðŸ„´','ðŸ„µ','ðŸ„¶','ðŸ„·','ðŸ„¸','ðŸ„¹','ðŸ„º','ðŸ„»','ðŸ„¼',
    'ðŸ„½','ðŸ„¾','ðŸ„¿','ðŸ…€','ðŸ…','ðŸ…‚','ðŸ…ƒ','ðŸ…„','ðŸ……','ðŸ…†','ðŸ…‡','ðŸ…ˆ','ðŸ…‰',
    'ðŸ„°','ðŸ„±','ðŸ„²','ðŸ„³','ðŸ„´','ðŸ„µ','ðŸ„¶','ðŸ„·','ðŸ„¸','ðŸ„¹','ðŸ„º','ðŸ„»','ðŸ„¼',
    'ðŸ„½','ðŸ„¾','ðŸ„¿','ðŸ…€','ðŸ…','ðŸ…‚','ðŸ…ƒ','ðŸ…„','ðŸ……','ðŸ…†','ðŸ…‡','ðŸ…ˆ','ðŸ…‰'];
  const underline=[
    'aÌ²','bÌ²','cÌ²','dÌ²','eÌ²','fÌ²','gÌ²','hÌ²','iÌ²','jÌ²','kÌ²','lÌ²','mÌ²',
    'nÌ²','oÌ²','pÌ²','qÌ²','rÌ²','sÌ²','tÌ²','uÌ²','vÌ²','wÌ²','xÌ²','yÌ²','zÌ²',
    'AÌ²','BÌ²','CÌ²','DÌ²','EÌ²','FÌ²','GÌ²','HÌ²','IÌ²','JÌ²','KÌ²','LÌ²','MÌ²',
    'NÌ²','OÌ²','PÌ²','QÌ²','RÌ²','SÌ²','TÌ²','UÌ²','VÌ²','WÌ²','XÌ²','YÌ²','ZÌ²'];
  // This doesn't work as expected in all fonts
  const underlineTwice=[
    'aÌ³','bÌ³','cÌ³','dÌ³','eÌ³','fÌ³','gÌ³','hÌ³','iÌ³','jÌ³','kÌ³','lÌ³','mÌ³',
    'nÌ³','oÌ³','pÌ³','qÌ³','rÌ³','sÌ³','tÌ³','uÌ³','vÌ³','wÌ³','xÌ³','yÌ³','zÌ³',
    'AÌ³','BÌ³','CÌ³','DÌ³','EÌ³','FÌ³','GÌ³','HÌ³','IÌ³','JÌ³','KÌ³','LÌ³','MÌ³',
    'NÌ³','OÌ³','PÌ³','QÌ³','RÌ³','SÌ³','TÌ³','UÌ³','VÌ³','WÌ³','XÌ³','YÌ³','ZÌ³'];
  const inputChat=document.getElementById('InputChat');
  if(inputChat===null)return;
  let text=inputChat.value;
  if(text.length>0&&text[0]==' ')return true;
  // Bold
  text=chatBoxSubstitute(text,/^(.*)\*(.+)\*(.*)$/,sansBold);
  // Circle
  text=chatBoxSubstitute(text,/^(.*)\(\((.+)\)\)(.*)$/,circleWhite);
  // Courier
  text=chatBoxSubstitute(text,/^(.*)=(.+)=(.*)$/,courier);
  // Cursive
  text=chatBoxSubstitute(text,/^(.*)~(.+)~(.*)$/,cursiveBold);
  // Fraktur
  if(text.match(/^(.*)##(.*)#(.*)$/)===null
     &&text.match(/^(.*)#(.*)##(.*)$/)===null)
    text=chatBoxSubstitute(text,/^(.*)#(.+)#(.*)$/,fraktur);
  text=chatBoxSubstitute(text,/^(.*)##(.+)##(.*)$/,frakturBold);
  // Italic
  text=chatBoxSubstitute(text,/^(.*)\/(.+)\/(.*)$/,sansBoldItalic);
  // Outline
  text=chatBoxSubstitute(text,/^(.*)\|(.+)\|(.*)$/,outline);
  // Square
  text=chatBoxSubstitute(text,/^(.*)\[\[(.+)\]\](.*)$/,squareWhite);
  // Underline
  text=chatBoxSubstitute(text,/^(.*)_(.+)_(.*)$/,underline);
  inputChat.value=text;
  return true;}

function chatBoxInit(){
  let inputChat=document.getElementById('InputChat');
  if(inputChat===null){
    console.log('No chat box found');
    return;}
  inputChat.setAttribute('onkeyup','chatBoxTransform()');}

chatBoxInit();
chatBoxTransform();
